<html>
  <head>
    <style>
     body {
       font-family: helvetica;
       font-size: 14px;
     }
     #stats {
       width: 250px;
       display: flex;
       justify-content: space-between;
       align-items: center;
       flex-direction: row;
       flex-flow: row wrap;
     }
     #container {
       width: 100%;
       height: 100%;
       position: absolute;
       left: 0;
       top: 0;
       z-index: 999;
     }
     h1 {
       opacity: 0.5;
       font-size: 1em;
     }
    </style>

    <script src="https://cytoscape.github.io/cytoscape.js/api/cytoscape.js-latest/cytoscape.min.js"></script>
    <script src="https://cdn.rawgit.com/cytoscape/cytoscape.js-spread/1.0.9/cytoscape-spread.js"></script>
    <!-- when im working locally -->
    <!-- <script src="./ExampleChocApp/ExampleChocApp.js"></script> -->

    <script>
     var chocOutput = {
       nodes: [
         { data: { id: 'root', name: 'root', noun: 'lightgrey' } },
         { data: { id: 'homepage', name: 'homepage', noun: 'lightgrey' } },
         { data: { id: 'categories', name: 'categories', noun: 'lightgrey' } },
         { data: { id: 'review', name: 'review', noun: 'lightgrey' } },
         { data: { id: 'reviews', name: 'reviews', noun: 'lightgrey' } },
         { data: { id: 'products', name: 'products', noun: 'lightgrey' } },
         { data: { id: 'product', name: 'product', noun: 'lightgrey' } },
         { data: { id: 'cart', name: 'cart', noun: 'lightgrey' } },
         { data: { id: 'invoice', name: 'invoice', noun: 'green' } },
         { data: { id: 'vendors', name: 'vendors', noun: 'lightgrey' } },
         { data: { id: 'vendor', name: 'vendor', noun: 'lightgrey' } },
         { data: { id: 'error', name: 'error', noun: 'red' } },

       ],
       edges: [
         { data: { source: 'root', target: 'homepage', label: 'shoppe', color: 'green' } },
         { data: { source: 'homepage', target: 'product', label: 'top_5_product_id', color: 'green' } },
         { data: { source: 'homepage', target: 'categories', label: 'by_category', color: 'green' } },
         { data: { source: 'homepage', target: 'vendors', label: 'by_vendor', color: 'green' } },
         { data: { source: 'categories', target: 'products', label: 'category_id', color: 'green' } },
         { data: { source: 'products', target: 'product', label: 'product_id', color: 'green' } },
         { data: { source: 'products', target: 'products', label: 'by_rating', color: 'green' } },
         { data: { source: 'product', target: 'reviews', label: 'reviews', color: 'green' } },
         { data: { source: 'reviews', target: 'review', label: 'review_id', color: 'green' } },
         { data: { source: 'reviews', target: 'review', label: 'add', color: 'purple' } },
         { data: { source: 'review', target: 'review', label: 'edit', color: 'blue' } },
         { data: { source: 'product', target: 'cart', label: 'add', color: 'purple' } },
         { data: { source: 'cart', target: 'cart', label: 'remove', color: 'red' } },
         { data: { source: 'cart', target: 'invoice', label: 'buy', color: 'purple' } },
         { data: { source: 'product', target: 'vendor', label: 'vendor_id', color: 'green' } },
         { data: { source: 'vendors', target: 'vendor', label: 'vendor_id', color: 'green' } },
         { data: { source: 'vendor', target: 'products', label: 'products', color: 'green' } },
         { data: { source: 'error', target: 'root', label: 'home', color: 'green' } },

       ]
     };

     document.addEventListener("DOMContentLoaded", function(event) {
       var cy = window.cy = cytoscape({
         container: document.querySelector('#container'),

         boxSelectionEnabled: false,
         autounselectify: true,

         style: cytoscape.stylesheet()
                         .selector('node')
                         .css({
                           'content': 'data(name)',
                           'text-valign': 'center',
                           'color': 'white',
                           'text-outline-width': 2,
                           'background-color': 'data(noun)',
                           'text-outline-color': '#999'
                         })
                         .selector('edge')
                         .css({
                           'curve-style': 'bezier',
                           'target-arrow-shape': 'triangle',
                           'target-arrow-color': 'data(color)',
                           'line-color': 'data(color)',
                           'width': 1,
                           'label': 'data(label)'
                         })
                         .selector('.selected')
                         .css({
                           'background-color': '#61bffc',
                           'line-color': '#61bffc',
                           'target-arrow-color': '#61bffc',
                           'transition-property': 'background-color, line-color, target-arrow-color',
                           'transition-duration': '0.5s'
                         })
                         .selector('.faded')
                         .css({
                           'opacity': 0.25,
                           'text-opacity': 0
                         }),
         elements: chocOutput,
         layout: {
           name: 'spread'
         }
       });

       cy.on('tap', 'node', function(e){
         var node = e.cyTarget;
         var targetId = node.data().id;
         var dijkstra = cy.elements().dijkstra('#root');
         var pathToTarget = dijkstra.pathTo( cy.$('#' + targetId) );
         var distToTarget = dijkstra.distanceTo( cy.$('#' + targetId) );
         document.getElementById("path_length").textContent="" + (distToTarget - 1);

         cy.elements().removeClass('selected');
         pathToTarget.addClass('selected');
       });
     });
    </script>
  </head>
  <body>
    <div id="stats"><h2>current path length:</h2> <h2 id="path_length"></h2></div>
    <div id="container"></div>
  </body>
</html>
